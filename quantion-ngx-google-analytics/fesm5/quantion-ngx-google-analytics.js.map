{"version":3,"file":"quantion-ngx-google-analytics.js","sources":["ng://quantion-ngx-google-analytics/lib/services/config.service.ts","ng://quantion-ngx-google-analytics/lib/services/google-analytics-event-tracking.service.ts","ng://quantion-ngx-google-analytics/lib/config/ga-config.ts","ng://quantion-ngx-google-analytics/lib/google-analytics.module.ts","ng://quantion-ngx-google-analytics/public-api.ts","ng://quantion-ngx-google-analytics/quantion-ngx-google-analytics.ts"],"sourcesContent":["import { ModuleConfig } from '../interfaces/module-config.interface';\r\n\r\nexport class ConfigService {\r\n\r\n  // tslint:disable-next-line: no-inferrable-types\r\n  public googleAnalyticsId: string = '';\r\n\r\n  constructor(config: ModuleConfig = { googleAnalyticsId: null }) {\r\n    this.googleAnalyticsId = config.googleAnalyticsId;\r\n  }\r\n}\r\n","import { Injectable, RendererFactory2 } from '@angular/core';\r\nimport { Router, NavigationEnd } from '@angular/router';\r\nimport { ConfigService } from './config.service';\r\nimport { GAEventsInterface } from '../interfaces/ga-events.interface';\r\n\r\n// tslint:disable-next-line: ban-types\r\ndeclare let gtag: Function;\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class GoogleAnalyticsEventTrackingService {\r\n\r\n  constructor(\r\n    private configService: ConfigService,\r\n    private router: Router,\r\n    private rendererFactory: RendererFactory2\r\n  ) {}\r\n\r\n  public trackNavigation(): void {\r\n    this.loadScripts();\r\n    this.router.events.subscribe(event => {\r\n      if (event instanceof NavigationEnd && gtag) {\r\n        gtag('config', this.configService.googleAnalyticsId, { page_path: event.urlAfterRedirects });\r\n       }\r\n    });\r\n  }\r\n\r\n  public event(gaEvent: GAEventsInterface): void {\r\n    const { eventAction, eventCategory, eventLabel, eventValue } = gaEvent;\r\n    gtag('event', eventAction, { event_category: eventCategory, event_label: eventLabel, value: eventValue });\r\n  }\r\n\r\n  private loadScripts(): void {\r\n    const renderer = this.rendererFactory.createRenderer(null, null);\r\n    const script = renderer.createElement('script');\r\n    script.src = 'https://www.googletagmanager.com/gtag/js?id=' + this.configService.googleAnalyticsId;\r\n    const head = renderer.selectRootElement('head', true);\r\n    renderer.appendChild(head, script);\r\n    const gaScript = renderer.createElement('script');\r\n    gaScript.text = `\r\n      window.dataLayer = window.dataLayer || [];\r\n      function gtag() {\r\n        dataLayer.push(arguments);\r\n      }\r\n      gtag(\"js\", new Date());\r\n      gtag(\"config\", \"${ this.configService.googleAnalyticsId }\");`;\r\n    renderer.appendChild(head, gaScript);\r\n  }\r\n}\r\n","import { InjectionToken } from '@angular/core';\r\nimport { ModuleConfig } from '../interfaces/module-config.interface';\r\nimport { ConfigService } from '../services/config.service';\r\n\r\nexport const FOR_ROOT_OPTIONS_TOKEN = new InjectionToken<ModuleConfig>('forRoot() configuration');\r\n\r\nexport function ProvideConfig(config: ModuleConfig): ModuleConfig {\r\n  const configService: ConfigService = new ConfigService(config);\r\n  return configService;\r\n}\r\n","import { NgModule, ModuleWithProviders } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { GoogleAnalyticsEventTrackingService } from './services/google-analytics-event-tracking.service';\r\nimport { FOR_ROOT_OPTIONS_TOKEN, ProvideConfig } from './config/ga-config';\r\nimport { ConfigService } from './services/config.service';\r\nimport { ModuleConfig } from './interfaces/module-config.interface';\r\n\r\n\r\n@NgModule({\r\n  declarations: [],\r\n  imports: [\r\n    CommonModule\r\n  ],\r\n  providers: [\r\n  ]\r\n})\r\nexport class GoogleAnalyticsModule {\r\n  static forRoot(config: ModuleConfig): ModuleWithProviders {\r\n    return {\r\n      ngModule: GoogleAnalyticsModule,\r\n      providers: [\r\n        GoogleAnalyticsEventTrackingService,\r\n        {\r\n          provide: FOR_ROOT_OPTIONS_TOKEN,\r\n          useValue: config\r\n        },\r\n        {\r\n          provide: ConfigService,\r\n          useFactory: ProvideConfig,\r\n          deps: [FOR_ROOT_OPTIONS_TOKEN]\r\n        }\r\n      ]\r\n    };\r\n  }\r\n}\r\n","/*\r\n * Public API Surface of quantion-ngx-google-analytics\r\n */\r\nexport * from './lib/services/google-analytics-event-tracking.service';\r\nexport * from './lib/google-analytics.module';\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {FOR_ROOT_OPTIONS_TOKEN as ɵc,ProvideConfig as ɵd} from './lib/config/ga-config';\nexport {ModuleConfig as ɵb} from './lib/interfaces/module-config.interface';\nexport {ConfigService as ɵa} from './lib/services/config.service';"],"names":[],"mappings":"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"}